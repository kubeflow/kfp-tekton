apiVersion: tekton.dev/v1beta1
kind: PipelineRun
metadata:
  name: my-pipeline
  annotations:
    tekton.dev/output_artifacts: '{}'
    tekton.dev/input_artifacts: '{}'
    tekton.dev/artifact_bucket: mlpipeline
    tekton.dev/artifact_endpoint: minio-service.kubeflow:9000
    tekton.dev/artifact_endpoint_scheme: http://
    tekton.dev/artifact_items: '{"my-in-coop1": []}'
    sidecar.istio.io/inject: "false"
    pipelines.kubeflow.org/big_data_passing_format: $(workspaces.$TASK_NAME.path)/artifacts/$ORIG_PR_NAME/$TASKRUN_NAME/$TASK_PARAM_NAME
    pipelines.kubeflow.org/pipeline_spec: '{"inputs": [{"default": "10", "name": "my_pipe_param",
      "optional": true, "type": "Integer"}], "name": "my-pipeline"}'
    tekton.dev/resource_templates: '[{"apiVersion": "custom.tekton.dev/v1alpha1",
      "kind": "PipelineLoop", "metadata": {"name": "my-pipeline-for-loop-3"}, "spec":
      {"iterateParam": "loop-item-param-2", "iterateParamStringSeparator": ",", "pipelineSpec":
      {"params": [{"name": "my_pipe_param", "type": "string"}, {"name": "separator",
      "type": "string"}], "tasks": [{"name": "my-in-coop1", "params": [{"name": "loop-item-param-2",
      "value": "$(params.loop-item-param-2)"}, {"name": "my_pipe_param", "value":
      "$(params.my_pipe_param)"}], "taskSpec": {"metadata": {"annotations": {"pipelines.kubeflow.org/component_spec_digest":
      "{\"name\": \"my-in-coop1\", \"outputs\": [], \"version\": \"my-in-coop1@sha256=42f0c6a60c7e435441b8afaeb382a771a9741fe3aabb203748fdbd72b25f1628\"}",
      "tekton.dev/template": ""}, "labels": {"pipelines.kubeflow.org/cache_enabled":
      "true", "pipelines.kubeflow.org/generation": "", "pipelines.kubeflow.org/pipelinename":
      ""}}, "params": [{"name": "loop-item-param-2", "type": "string"}, {"name": "my_pipe_param",
      "type": "string"}], "steps": [{"args": ["set -e\necho op1 \"$0\" \"$1\"\n",
      "$(inputs.params.loop-item-param-2)", "$(inputs.params.my_pipe_param)"], "command":
      ["sh", "-c"], "image": "library/bash:4.4.23", "name": "main"}]}, "timeout":
      "525600m"}]}}}]'
spec:
  params:
  - name: my_pipe_param
    value: '10'
  pipelineSpec:
    params:
    - name: my_pipe_param
      default: '10'
    tasks:
    - name: my-pipeline-for-loop-3
      taskRef:
        apiVersion: custom.tekton.dev/v1alpha1
        kind: PipelineLoop
        name: my-pipeline-for-loop-3
      params:
      - name: my_pipe_param
        value: $(params.my_pipe_param)
      - name: separator
        value: ','
  timeout: 525600m
